<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Aikido DAB Lern-App 3.0</title>

    <!-- PWA -->
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#121e30">
    <link rel="apple-touch-icon" sizes="180x180" href="data:image/png;base64,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">
    <link rel="icon" type="image/png" sizes="32x32" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABxUlEQVR4nGMUkjH4zzCAgIUcTW8fn9fEJScsa3idJg5AthSfJcSqgwFGQlEAM5BUnxGrF68D3j4+r4lN89vH55/j0iMsayhJrDl4HYBNEz6LCTkElyOwOgBdMSkW43MINkdgOIAYy7EFM7Hq0c1HcQAhy/FZTMghuBzBRI4BxAAsaQBrNDIhKcCZUsn1OS59wrKG12FZFGsIEGMIPn249GMLBZxRQCpAN5zYnMMoJGPwHzn4yfE9MTkFm7lvH5/XpDgESM2m6IAiB1BqOUUOoIblZDuAWpaT5QBqWk6yA6htOdwByCUTroKDEstxZUFhWcPrRIcAumWU+hwGsDoAVyjAxKlZNzAhScKjgVRDiLEcTZxwdUxsdUqs5bgcPrhaRKQ4glhAcpsQn2K6tYoJaaJLvwBZM9Rg+veMsBlGyEBS+4YsDAwMDOzsbP9uXti3m5eH+4+ta5jdtRu3ee1tzd+sWzbjpHdQkiU7B9s/BgaGHu+gJMuPnz6zvn18fiUDA8NtBgaG0wwMDGkMDAxToWal//v3r/fjp88sJ09fEJKTkfr+6MkzTgYGBoaIUN8nRTnJd6QkxX/cunOfp7a5T/Po8TPCAKLAbY80UGUuAAAAAElFTkSuQmCC">
    <link rel="icon" type="image/png" sizes="16x16" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAsUlEQVR4nJWTQQrEIAxFVXoCXQlm3+70/ofo0gMUZlY9Q7rRIpmfqS1IIT8v/o9qfcpswHce+yZrgUqVtUUDUTPSFtnQxfPYv5qDsc/NwmM9UKndjfUp8wwsnMS+qRsFCQcqsTdrfZaZ12bpB35yFKhEpwmzceAADUZx4IBZ+K8DBMNIPmVm5rX9P3L5lBlpnXNoJxlHO6E7wniztKwgzhaoVDcIj0MkbEy7ysLyq9d4AVBkrSN1iQIkAAAAAElFTkSuQmCC">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="Aikido">
    
    <style>
        :root {
            --bg-primary: #ffffff;
            --bg-secondary: #f5f5f5;
            --text-primary: #333333;
            --text-secondary: #666666;
            --border-color: #dddddd;
            --accent-color: #1976D2;
            --success-color: #2E7D32;
            --warning-color: #FF8C00;
            --error-color: #D32F2F;
            --gelb: #FDB813;
            --orange: #FF8C00;
            --gruen: #2E7D32;
            --blau: #1976D2;
            --braun: #5D4037;
        }

        [data-theme="dark"] {
            --bg-primary: #1a1a1a;
            --bg-secondary: #2a2a2a;
            --text-primary: #e0e0e0;
            --text-secondary: #999999;
            --border-color: #444444;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Arial, sans-serif;
            background: var(--bg-secondary);
            color: var(--text-primary);
            transition: background 0.3s, color 0.3s;
            padding-bottom: 20px;
        }

        /* Navigation */
        .nav {
            background: var(--bg-primary);
            padding: 15px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .nav-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .nav-title {
            font-size: 1.3em;
            font-weight: 600;
        }

        .menu-btn {
            background: none;
            border: none;
            font-size: 1.5em;
            cursor: pointer;
            color: var(--text-primary);
            padding: 5px 10px;
        }

        .nav-tabs {
            display: flex;
            gap: 10px;
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
        }

        .tab-btn {
            flex: 1;
            min-width: fit-content;
            padding: 10px 15px;
            background: var(--bg-secondary);
            border: 2px solid var(--border-color);
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.9em;
            font-weight: 500;
            color: var(--text-primary);
            transition: all 0.2s;
            white-space: nowrap;
        }

        .tab-btn.active {
            background: var(--accent-color);
            color: white;
            border-color: var(--accent-color);
        }

        /* Container */
        .container {
            max-width: 800px;
            margin: 20px auto;
            padding: 0 15px;
        }

        .section {
            display: none;
        }

        .section.active {
            display: block;
        }

        /* Karten */
        .card {
            background: var(--bg-primary);
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }

        .card-title {
            font-size: 1.1em;
            font-weight: 600;
            margin-bottom: 10px;
        }

        /* Kyu-Badges */
        .kyu-badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 4px;
            font-size: 0.85em;
            font-weight: 600;
            color: white;
            margin-right: 8px;
        }

        .kyu-gelb { background: var(--gelb); color: #333; }
        .kyu-orange { background: var(--orange); }
        .kyu-gruen { background: var(--gruen); }
        .kyu-blau { background: var(--blau); }
        .kyu-braun { background: var(--braun); }

        /* Filter-Buttons */
        .filter-row {
            display: flex;
            gap: 8px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .filter-btn {
            padding: 8px 16px;
            border: 2px solid var(--border-color);
            background: var(--bg-primary);
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.9em;
            font-weight: 500;
            color: var(--text-primary);
            transition: all 0.2s;
        }

        .filter-btn.active {
            border-color: var(--accent-color);
            background: var(--accent-color);
            color: white;
        }

        /* Video-Links */
        .video-link {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 6px 12px;
            margin: 4px 4px 4px 0;
            background: var(--bg-secondary);
            border-radius: 6px;
            text-decoration: none;
            color: var(--accent-color);
            font-size: 0.9em;
            transition: all 0.2s;
        }

        .video-link:hover {
            background: var(--accent-color);
            color: white;
        }

        .video-icon::before {
            content: "‚ñ∂";
            font-size: 0.8em;
        }

        /* Lernkarten */
        .flashcard {
            background: var(--bg-primary);
            border-radius: 12px;
            padding: 30px;
            min-height: 300px;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            cursor: pointer;
            transition: transform 0.6s;
            transform-style: preserve-3d;
            position: relative;
        }

        .flashcard.flipped {
            transform: rotateY(180deg);
        }

        .card-front, .card-back {
            backface-visibility: hidden;
            position: absolute;
            width: 100%;
            height: 100%;
            padding: 30px;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        .card-back {
            transform: rotateY(180deg);
        }

        .card-question {
            font-size: 1.3em;
            font-weight: 600;
            text-align: center;
            margin-bottom: 10px;
        }

        .card-detail {
            font-size: 1.1em;
            color: var(--text-secondary);
            text-align: center;
            margin: 5px 0;
        }

        /* Bewertungs-Buttons */
        .rating-section {
            margin-top: 20px;
            text-align: center;
        }

        .rating-title {
            font-weight: 600;
            margin-bottom: 5px;
        }

        .rating-subtitle {
            font-size: 0.85em;
            color: var(--text-secondary);
            font-style: italic;
            margin-bottom: 15px;
        }

        .rating-buttons {
            display: flex;
            gap: 10px;
            justify-content: center;
        }

        .rating-btn {
            flex: 1;
            max-width: 120px;
            padding: 12px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.9em;
            font-weight: 600;
            transition: all 0.2s;
        }

        .rating-good {
            background: var(--success-color);
            color: white;
        }

        .rating-ok {
            background: var(--warning-color);
            color: white;
        }

        .rating-hard {
            background: var(--error-color);
            color: white;
        }

        /* Accordion */
        .accordion-item {
            margin-bottom: 10px;
        }

        .accordion-header {
            background: var(--bg-primary);
            padding: 15px;
            border-radius: 8px;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }

        .accordion-header:hover {
            background: var(--bg-secondary);
        }

        .accordion-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease;
        }

        .accordion-content.open {
            max-height: 5000px;
        }

        .accordion-body {
            padding: 15px;
            background: var(--bg-primary);
            border-radius: 0 0 8px 8px;
            margin-top: 2px;
        }

        /* Technikliste */
        .technique-item {
            padding: 12px;
            background: var(--bg-secondary);
            border-radius: 6px;
            margin-bottom: 8px;
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .technique-name {
            font-weight: 600;
        }

        .attack-name {
            color: var(--text-secondary);
            font-size: 0.95em;
        }

        /* Kategorien */
        .category-section {
            margin-bottom: 30px;
        }

        .category-title {
            font-size: 1.2em;
            font-weight: 700;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--accent-color);
        }

        /* Men√º Sidebar */
        .sidebar {
            position: fixed;
            right: -100%;
            top: 0;
            width: 300px;
            height: 100%;
            background: var(--bg-primary);
            box-shadow: -2px 0 5px rgba(0,0,0,0.1);
            transition: right 0.3s;
            z-index: 1000;
            overflow-y: auto;
        }

        .sidebar.open {
            right: 0;
        }

        .sidebar-header {
            padding: 20px;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .sidebar-title {
            font-size: 1.2em;
            font-weight: 600;
        }

        .close-btn {
            background: none;
            border: none;
            font-size: 1.5em;
            cursor: pointer;
            color: var(--text-primary);
        }

        .sidebar-content {
            padding: 20px;
        }

        .sidebar-section {
            margin-bottom: 25px;
        }

        .sidebar-section-title {
            font-weight: 600;
            margin-bottom: 10px;
        }

        .theme-toggle {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 10px;
            background: var(--bg-secondary);
            border-radius: 6px;
        }

        .switch {
            position: relative;
            width: 50px;
            height: 26px;
        }

        .switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: .4s;
            border-radius: 26px;
        }

        .slider:before {
            position: absolute;
            content: "";
            height: 18px;
            width: 18px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }

        input:checked + .slider {
            background-color: var(--accent-color);
        }

        input:checked + .slider:before {
            transform: translateX(24px);
        }

        .link-list {
            list-style: none;
        }

        .link-list li {
            margin-bottom: 10px;
        }

        .link-list a {
            color: var(--accent-color);
            text-decoration: none;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .link-list a:hover {
            text-decoration: underline;
        }

        .disclaimer {
            font-size: 0.85em;
            color: var(--text-secondary);
            line-height: 1.5;
        }

        .credits {
            font-size: 0.9em;
            line-height: 1.6;
        }

        /* Overlay */
        .overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            display: none;
            z-index: 999;
        }

        .overlay.active {
            display: block;
        }

        /* Hilfstexte */
        .info-text {
            color: var(--text-secondary);
            font-size: 0.9em;
            margin-bottom: 15px;
        }

        /* Empty State */
        .empty-state {
            text-align: center;
            padding: 40px 20px;
            color: var(--text-secondary);
        }

        .empty-state-icon {
            font-size: 3em;
            margin-bottom: 10px;
        }

        /* Progress */
        .progress-info {
            background: var(--bg-secondary);
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
        }

        .progress-stat {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
        }

        /* Navigation Buttons */
        .nav-buttons {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }

        .nav-button {
            flex: 1;
            padding: 12px;
            border: none;
            border-radius: 8px;
            background: var(--accent-color);
            color: white;
            font-size: 1em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
        }

        .nav-button:hover {
            opacity: 0.9;
        }

        .nav-button:disabled {
            background: var(--border-color);
            cursor: not-allowed;
        }

        /* Responsive */
        @media (max-width: 600px) {
            .sidebar {
                width: 85%;
            }
            
            .nav-tabs {
                font-size: 0.85em;
            }
            
            .tab-btn {
                padding: 8px 12px;
            }
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <div class="nav">
        <div class="nav-header">
            <div class="nav-title">ü•ã Aikido DAB 3.0</div>
            <button class="menu-btn" onclick="toggleSidebar()">‚ò∞</button>
        </div>
        <div class="nav-tabs">
            <button class="tab-btn active" onclick="showTab('pruefungsordnung')">Pr√ºfungsordnung</button>
            <button class="tab-btn" onclick="showTab('techniken')">Techniken</button>
            <button class="tab-btn" onclick="showTab('angriffe')">Angriffe</button>
            <button class="tab-btn" onclick="showTab('lernkarten-angriffe')">Angriffe √ºben</button>
            <button class="tab-btn" onclick="showTab('lernkarten-techniken')">Techniken √ºben</button>
        </div>
    </div>

    <!-- Container -->
    <div class="container">
        <!-- Pr√ºfungsordnung DAB -->
        <div id="pruefungsordnung" class="section active">
            <div class="info-text">Techniken sortiert nach Kyu-Stufen. Nur neue Kombinationen je Stufe.</div>
            <div id="pruefungsordnung-content"></div>
        </div>

        <!-- Techniken -->
        <div id="techniken" class="section">
            <div class="info-text">W√§hle Kyu-Stufen zum Filtern:</div>
            <div class="filter-row">
                <button class="filter-btn" data-kyu="Gelb (5. Kyu)" onclick="toggleFilter(this)">Gelb</button>
                <button class="filter-btn" data-kyu="Orange (4. Kyu)" onclick="toggleFilter(this)">Orange</button>
                <button class="filter-btn" data-kyu="Gr√ºn (3. Kyu)" onclick="toggleFilter(this)">Gr√ºn</button>
                <button class="filter-btn" data-kyu="Blau (2. Kyu)" onclick="toggleFilter(this)">Blau</button>
                <button class="filter-btn" data-kyu="Braun (1. Kyu)" onclick="toggleFilter(this)">Braun</button>
            </div>
            <div id="techniken-content"></div>
        </div>

        <!-- Angriffe -->
        <div id="angriffe" class="section">
            <div class="info-text">Angriffsformen kategorisiert nach Typ.</div>
            <div id="angriffe-content"></div>
        </div>

        <!-- Lernkarten Angriffe (Spaced Repetition) -->
        <div id="lernkarten-angriffe" class="section">
            <div class="info-text">Lerne die japanischen Angriffsnamen mit Spaced Repetition.</div>
            <div id="angriffe-progress" class="progress-info" style="display:none;"></div>
            <div id="angriffe-techniken-lernkarten-content"></div>
        </div>

        <!-- Lernkarten Techniken (mit Bericht) -->
        <div id="lernkarten-techniken" class="section">
            <div class="info-text">W√§hle Kyu-Stufen zum √úben:</div>
            <div class="filter-row">
                <button class="filter-btn" data-kyu="Gelb (5. Kyu)" onclick="toggleLernkartenFilter(this)">Gelb</button>
                <button class="filter-btn" data-kyu="Orange (4. Kyu)" onclick="toggleLernkartenFilter(this)">Orange</button>
                <button class="filter-btn" data-kyu="Gr√ºn (3. Kyu)" onclick="toggleLernkartenFilter(this)">Gr√ºn</button>
                <button class="filter-btn" data-kyu="Blau (2. Kyu)" onclick="toggleLernkartenFilter(this)">Blau</button>
                <button class="filter-btn" data-kyu="Braun (1. Kyu)" onclick="toggleLernkartenFilter(this)">Braun</button>
            </div>
            <div style="margin: 15px 0;">
                <button class="nav-button" onclick="showTechnikenBericht()" style="max-width: 300px;">
                    üìä Bericht anzeigen
                </button>
            </div>
            <div id="techniken-progress" class="progress-info" style="display:none;"></div>
            <div id="techniken-techniken-lernkarten-content"></div>
        </div>
    </div>

    <!-- Bericht Modal -->
    <div id="bericht-modal" class="overlay" style="z-index: 1001;">
        <div style="background: var(--bg-primary); max-width: 600px; margin: 50px auto; padding: 30px; border-radius: 12px; max-height: 80vh; overflow-y: auto;">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                <h2>üìä Trainings-Bericht</h2>
                <button class="close-btn" onclick="closeTechnikenBericht()">√ó</button>
            </div>
            <div id="bericht-content"></div>
        </div>
    </div>

    <!-- Sidebar -->
    <div class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <div class="sidebar-title">Men√º</div>
            <button class="close-btn" onclick="toggleSidebar()">√ó</button>
        </div>
        <div class="sidebar-content">
            <!-- Dark Mode -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Design</div>
                <div class="theme-toggle">
                    <span>Dunkelmodus</span>
                    <label class="switch">
                        <input type="checkbox" id="theme-toggle" onchange="toggleTheme()">
                        <span class="slider"></span>
                    </label>
                </div>
            </div>

            <!-- Links -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">N√ºtzliche Links</div>
                <ul class="link-list">
                    <li><a href="https://www.aikido-bund.de/techniken/" target="_blank">üîó Deutscher Aikido Bund (DAB)</a></li>
                    <li><a href="https://wtv-aikido.de/" target="_blank">üîó WTV-Aikido</a></li>
                    <li><a href="https://www.werler-tv.de/aikido/" target="_blank">üîó Werler TV ‚Äì Aikido</a></li>
                </ul>
            </div>

            <!-- Disclaimer -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Hinweis</div>
                <div class="disclaimer">
                    Diese App nutzt externe Videoinhalte (YouTube) und Links zu Drittanbietern. Beim √ñffnen von Videos und externen Links verl√§sst du die App. F√ºr die Inhalte externer Seiten √ºbernehmen wir keine Verantwortung.
                </div>
            </div>

            <!-- Credits -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Entwicklung</div>
                <div class="credits">
                    Entwickelt von <strong>David Blanco</strong> (Aikido Werler TV) und <strong>Jorge Krey</strong> (WTV-Aikido) ‚Äì f√ºr die Aikido-Gemeinschaft.
                </div>
            </div>
        </div>
    </div>

    <!-- Overlay -->
    <div class="overlay" id="overlay" onclick="toggleSidebar()"></div>

    <script>
        // Daten laden und App initialisieren
        let aikidoData = [];
        let attackCards = [];
        let activeFilters = [];
        let activeLernkartenFilters = [];
        let currentCardIndex = 0;
        let lernkartenPool = [];
        let ratings = JSON.parse(localStorage.getItem('aikido_ratings') || '{}');
        
        // Angriffs-Lernkarten (Spaced Repetition)
        let attackCardIndex = 0;
        let attackCardQueue = [];
        let attackReviewQueue = [];
        let attackStats = JSON.parse(localStorage.getItem('aikido_attack_stats') || '{}');
        let currentAttackCard = null;
        let isAttackFlipped = false;

        // Theme
        function toggleTheme() {
            const html = document.documentElement;
            const isDark = html.getAttribute('data-theme') === 'dark';
            html.setAttribute('data-theme', isDark ? '' : 'dark');
            localStorage.setItem('theme', isDark ? 'light' : 'dark');
        }

        // Theme laden
        const savedTheme = localStorage.getItem('theme');
        if (savedTheme === 'dark') {
            document.documentElement.setAttribute('data-theme', 'dark');
            document.getElementById('theme-toggle').checked = true;
        }

        // Sidebar
        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            const overlay = document.getElementById('overlay');
            sidebar.classList.toggle('open');
            overlay.classList.toggle('active');
        }

        // Tab-Wechsel
        function showTab(tabName) {
            document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
            document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
            
            document.getElementById(tabName).classList.add('active');
            event.target.classList.add('active');
            
            // Tab-spezifische Initialisierung
            if (tabName === 'lernkarten-angriffe' && attackCards.length > 0) {
                initAttackCards();
            } else if (tabName === 'lernkarten-techniken') {
                // Wird durch Filter-Buttons initialisiert
            }
        }

        // Kyu-Badge-Klasse
        function getKyuClass(kyu) {
            if (kyu.includes('Gelb')) return 'kyu-gelb';
            if (kyu.includes('Orange')) return 'kyu-orange';
            if (kyu.includes('Gr√ºn')) return 'kyu-gruen';
            if (kyu.includes('Blau')) return 'kyu-blau';
            if (kyu.includes('Braun')) return 'kyu-braun';
            return '';
        }

        // Kyu-Kurzname
        function getKyuShortName(kyu) {
            if (kyu.includes('Gelb')) return 'Gelb';
            if (kyu.includes('Orange')) return 'Orange';
            if (kyu.includes('Gr√ºn')) return 'Gr√ºn';
            if (kyu.includes('Blau')) return 'Blau';
            if (kyu.includes('Braun')) return 'Braun';
            return kyu;
        }

        // Filter Toggle
        function toggleFilter(btn) {
            const kyu = btn.getAttribute('data-kyu');
            btn.classList.toggle('active');
            
            if (activeFilters.includes(kyu)) {
                activeFilters = activeFilters.filter(k => k !== kyu);
            } else {
                activeFilters.push(kyu);
            }
            
            renderTechniken();
        }

        // Lernkarten Filter
        function toggleLernkartenFilter(btn) {
            const kyu = btn.getAttribute('data-kyu');
            btn.classList.toggle('active');
            
            if (activeLernkartenFilters.includes(kyu)) {
                activeLernkartenFilters = activeLernkartenFilters.filter(k => k !== kyu);
            } else {
                activeLernkartenFilters.push(kyu);
            }
            
            initLernkarten();
        }

        // Pr√ºfungsordnung rendern
        function renderPruefungsordnung() {
            const container = document.getElementById('pruefungsordnung-content');
            const kyuOrder = ['Gelb (5. Kyu)', 'Orange (4. Kyu)', 'Gr√ºn (3. Kyu)', 'Blau (2. Kyu)', 'Braun (1. Kyu)'];
            
            let html = '';
            
            kyuOrder.forEach(kyu => {
                const techniques = aikidoData.filter(t => t.kyu === kyu);
                
                if (techniques.length === 0) return;
                
                const kyuShort = getKyuShortName(kyu);
                const kyuClass = getKyuClass(kyu);
                
                html += `
                    <div class="accordion-item">
                        <div class="accordion-header" onclick="toggleAccordion(this)">
                            <div>
                                <span class="kyu-badge ${kyuClass}">${kyuShort}</span>
                                <span>${techniques.length} Techniken</span>
                            </div>
                            <span>‚ñº</span>
                        </div>
                        <div class="accordion-content">
                            <div class="accordion-body">
                `;
                
                techniques.forEach(tech => {
                    html += `
                        <div class="technique-item">
                            <div class="technique-name">${tech.technique}${tech.variation ? ' ‚Äì ' + tech.variation : ''}</div>
                            <div class="attack-name">${tech.attack_jp}</div>
                        </div>
                    `;
                });
                
                html += `
                            </div>
                        </div>
                    </div>
                `;
            });
            
            container.innerHTML = html;
        }

        // Accordion Toggle
        function toggleAccordion(header) {
            const content = header.nextElementSibling;
            const arrow = header.querySelector('span:last-child');
            content.classList.toggle('open');
            arrow.textContent = content.classList.contains('open') ? '‚ñ≤' : '‚ñº';
        }

        // Techniken rendern
        function renderTechniken() {
            const container = document.getElementById('techniken-content');
            
            if (activeFilters.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-state-icon">üìã</div>
                        <div>W√§hle mindestens eine Kyu-Stufe aus</div>
                    </div>
                `;
                return;
            }
            
            const filtered = aikidoData.filter(t => activeFilters.includes(t.kyu));
            
            if (filtered.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-state-icon">üîç</div>
                        <div>Keine Techniken gefunden</div>
                    </div>
                `;
                return;
            }
            
            let html = '';
            
            filtered.forEach(tech => {
                const kyuClass = getKyuClass(tech.kyu);
                const kyuShort = getKyuShortName(tech.kyu);
                
                html += `
                    <div class="card">
                        <div style="margin-bottom: 10px;">
                            <span class="kyu-badge ${kyuClass}">${kyuShort}</span>
                        </div>
                        <div class="card-title">${tech.technique}${tech.variation ? ' ‚Äì ' + tech.variation : ''}</div>
                        <div class="attack-name" style="margin-bottom: 10px;">${tech.attack_jp}</div>
                        ${tech.videos.length > 0 ? '<div>' + tech.videos.map(v => 
                            `<a href="${v.url}" target="_blank" class="video-link">
                                <span class="video-icon"></span>${v.source}
                            </a>`
                        ).join('') + '</div>' : ''}
                    </div>
                `;
            });
            
            container.innerHTML = html;
        }

        // Angriffe rendern
        function renderAngriffe() {
            const container = document.getElementById('angriffe-content');
            
            // Alle einzigartigen Angriffe sammeln
            const attacks = [...new Set(aikidoData.map(t => t.attack_jp))];
            
            // Kategorisieren
            const schlagangriffe = ['Yokomen-uchi', 'Shomen-uchi', 'Shomen-tsuki'];
            const fassangriffe = attacks.filter(a => !schlagangriffe.some(s => a.includes(s)));
            
            let html = '';
            
            // Fassangriffe
            html += `
                <div class="category-section">
                    <div class="category-title">Fassangriffe</div>
            `;
            
            fassangriffe.sort().forEach(attack => {
                const example = aikidoData.find(t => t.attack_jp === attack);
                html += `
                    <div class="card">
                        <div class="card-title">${attack}</div>
                        <div class="attack-name">${example.attack_de}</div>
                    </div>
                `;
            });
            
            html += `</div>`;
            
            // Schlagangriffe
            html += `
                <div class="category-section">
                    <div class="category-title">Schlagangriffe</div>
            `;
            
            schlagangriffe.forEach(attackType => {
                const matching = attacks.filter(a => a.includes(attackType));
                matching.forEach(attack => {
                    const example = aikidoData.find(t => t.attack_jp === attack);
                    html += `
                        <div class="card">
                            <div class="card-title">${attack}</div>
                            <div class="attack-name">${example.attack_de}</div>
                        </div>
                    `;
                });
            });
            
            html += `</div>`;
            
            container.innerHTML = html;
        }

        // Lernkarten initialisieren
        function initLernkarten() {
            if (activeLernkartenFilters.length === 0) {
                document.getElementById('techniken-lernkarten-content').innerHTML = `
                    <div class="empty-state">
                        <div class="empty-state-icon">üé¥</div>
                        <div>W√§hle mindestens eine Kyu-Stufe zum √úben</div>
                    </div>
                `;
                document.getElementById('techniken-progress').style.display = 'none';
                return;
            }
            
            lernkartenPool = aikidoData.filter(t => activeLernkartenFilters.includes(t.kyu));
            
            if (lernkartenPool.length === 0) {
                document.getElementById('techniken-lernkarten-content').innerHTML = `
                    <div class="empty-state">
                        <div class="empty-state-icon">üîç</div>
                        <div>Keine Karten f√ºr diese Auswahl</div>
                    </div>
                `;
                document.getElementById('techniken-progress').style.display = 'none';
                return;
            }
            
            // Shuffle
            lernkartenPool.sort(() => Math.random() - 0.5);
            currentCardIndex = 0;
            
            showLernkarte();
        }

        // Lernkarte anzeigen
        function showLernkarte() {
            const container = document.getElementById('techniken-lernkarten-content');
            const progressEl = document.getElementById('techniken-progress');
            
            if (currentCardIndex >= lernkartenPool.length) {
                container.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-state-icon">‚úÖ</div>
                        <div style="margin-bottom: 15px;">Alle Karten durchgearbeitet!</div>
                        <button class="nav-button" onclick="initLernkarten()">Erneut √ºben</button>
                    </div>
                `;
                progressEl.style.display = 'none';
                return;
            }
            
            const card = lernkartenPool[currentCardIndex];
            const kyuClass = getKyuClass(card.kyu);
            const kyuShort = getKyuShortName(card.kyu);
            const cardId = `${card.technique}_${card.attack_jp}_${card.variation}`.replace(/\s/g, '_');
            const rating = ratings[cardId] || 'unknown';
            
            // Progress
            progressEl.style.display = 'block';
            progressEl.innerHTML = `
                <div class="progress-stat">
                    <span>Fortschritt:</span>
                    <strong>${currentCardIndex + 1} / ${lernkartenPool.length}</strong>
                </div>
            `;
            
            // Karte
            container.innerHTML = `
                <div class="flashcard" id="flashcard" onclick="flipCard()">
                    <div class="card-front">
                        <div style="text-align: center; margin-bottom: 20px;">
                            <span class="kyu-badge ${kyuClass}">${kyuShort}</span>
                        </div>
                        <div class="card-question">${card.technique}</div>
                        <div class="card-detail">${card.attack_jp}</div>
                        <div class="card-detail" style="font-weight: 600;">${card.variation}</div>
                        <div style="text-align: center; margin-top: 30px; color: var(--text-secondary); font-size: 0.9em;">
                            Zum Umdrehen tippen
                        </div>
                    </div>
                    <div class="card-back">
                        ${card.videos.length > 0 ? '<div style="margin-bottom: 20px;">' + card.videos.map(v => 
                            `<a href="${v.url}" target="_blank" class="video-link" onclick="event.stopPropagation()">
                                <span class="video-icon"></span>${v.source}
                            </a>`
                        ).join('') + '</div>' : '<div style="margin-bottom: 20px; text-align: center; color: var(--text-secondary);">Keine Videos verf√ºgbar</div>'}
                        
                        <div class="rating-section">
                            <div class="rating-title">SELBSTBEWERTUNG</div>
                            <div class="rating-subtitle">(sei ehrlich mit dir selbst)</div>
                            <div class="rating-buttons">
                                <button class="rating-btn rating-good" onclick="rateCard('good', '${cardId}'); event.stopPropagation();">
                                    üòä<br>Kann ich
                                </button>
                                <button class="rating-btn rating-ok" onclick="rateCard('ok', '${cardId}'); event.stopPropagation();">
                                    üòê<br>Geht so
                                </button>
                                <button class="rating-btn rating-hard" onclick="rateCard('hard', '${cardId}'); event.stopPropagation();">
                                    üòì<br>Schwer
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="nav-buttons">
                    <button class="nav-button" onclick="previousCard()" ${currentCardIndex === 0 ? 'disabled' : ''}>
                        ‚Üê Zur√ºck
                    </button>
                    <button class="nav-button" onclick="nextCard()">
                        Weiter ‚Üí
                    </button>
                </div>
            `;
        }

        function flipCard() {
            const card = document.getElementById('flashcard');
            if (card) card.classList.toggle('flipped');
        }

        function rateCard(rating, cardId) {
            ratings[cardId] = rating;
            localStorage.setItem('aikido_ratings', JSON.stringify(ratings));
            
            // Kurzes Feedback
            setTimeout(() => {
                nextCard();
            }, 300);
        }

        function nextCard() {
            currentCardIndex++;
            showLernkarte();
        }

        function previousCard() {
            if (currentCardIndex > 0) {
                currentCardIndex--;
                showLernkarte();
            }
        }

        // ========================================
        // ANGRIFFS-LERNKARTEN (Spaced Repetition)
        // ========================================
        
        function initAttackCards() {
            if (attackCards.length === 0) {
                document.getElementById('angriffe-techniken-lernkarten-content').innerHTML = `
                    <div class="empty-state">
                        <div class="empty-state-icon">‚öôÔ∏è</div>
                        <div>Lade Angriffskarten...</div>
                    </div>
                `;
                return;
            }
            
            // Queue initialisieren
            attackCardQueue = attackCards.map(card => {
                const stats = attackStats[card.jp] || {
                    correct: 0,
                    wrong: 0,
                    lastReview: 0,
                    nextReview: 0,
                    interval: 0
                };
                return {...card, stats};
            });
            
            // Sortieren: F√§llige zuerst
            const now = Date.now();
            attackCardQueue.sort((a, b) => {
                const aDue = a.stats.nextReview <= now;
                const bDue = b.stats.nextReview <= now;
                if (aDue && !bDue) return -1;
                if (!aDue && bDue) return 1;
                return a.stats.nextReview - b.stats.nextReview;
            });
            
            showNextAttackCard();
        }
        
        function showNextAttackCard() {
            // Review-Queue zuerst
            if (attackReviewQueue.length > 0) {
                currentAttackCard = attackReviewQueue.shift();
            } else if (attackCardQueue.length > 0) {
                currentAttackCard = attackCardQueue.shift();
            } else {
                // Fertig!
                document.getElementById('angriffe-techniken-lernkarten-content').innerHTML = `
                    <div class="empty-state">
                        <div class="empty-state-icon">‚úÖ</div>
                        <div style="margin-bottom: 15px;">Alle Angriffe durchgearbeitet!</div>
                        <button class="nav-button" onclick="initAttackCards()">Erneut √ºben</button>
                    </div>
                `;
                document.getElementById('angriffe-progress').style.display = 'none';
                return;
            }
            
            isAttackFlipped = false;
            renderAttackCard();
            updateAttackProgress();
        }
        
        function renderAttackCard() {
            const container = document.getElementById('angriffe-techniken-lernkarten-content');
            
            container.innerHTML = `
                <div class="flashcard ${isAttackFlipped ? 'flipped' : ''}" id="attack-flashcard" onclick="flipAttackCard()">
                    <div class="card-front">
                        <div class="card-question">${currentAttackCard.jp}</div>
                        <div style="text-align: center; margin-top: 30px; color: var(--text-secondary); font-size: 0.9em;">
                            Zum Umdrehen tippen
                        </div>
                    </div>
                    <div class="card-back">
                        <div class="card-question" style="font-size: 1.1em; margin-bottom: 30px;">
                            ${currentAttackCard.de}
                        </div>
                        <div class="rating-section">
                            <div class="rating-title">Wusstest du die Antwort?</div>
                            <div class="rating-buttons" style="margin-top: 20px;">
                                <button class="rating-btn rating-good" onclick="answerAttackCard(true); event.stopPropagation();">
                                    ‚úì<br>Ja
                                </button>
                                <button class="rating-btn rating-hard" onclick="answerAttackCard(false); event.stopPropagation();">
                                    ‚úó<br>Nein
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }
        
        function flipAttackCard() {
            isAttackFlipped = !isAttackFlipped;
            const card = document.getElementById('attack-flashcard');
            if (card) card.classList.toggle('flipped');
        }
        
        function answerAttackCard(correct) {
            const now = Date.now();
            const stats = currentAttackCard.stats;
            
            if (correct) {
                stats.correct++;
                // Intervall erh√∂hen
                if (stats.interval === 0) {
                    stats.interval = 10 * 60 * 1000; // 10 Min
                } else {
                    stats.interval *= 2.5;
                }
                stats.nextReview = now + stats.interval;
            } else {
                stats.wrong++;
                stats.interval = 0;
                stats.nextReview = now + (1 * 60 * 1000); // 1 Min
                // Wieder in Review-Queue
                attackReviewQueue.push(currentAttackCard);
            }
            
            stats.lastReview = now;
            attackStats[currentAttackCard.jp] = stats;
            localStorage.setItem('aikido_attack_stats', JSON.stringify(attackStats));
            
            setTimeout(() => showNextAttackCard(), 300);
        }
        
        function updateAttackProgress() {
            const progressEl = document.getElementById('angriffe-progress');
            const total = attackCards.length;
            const learned = attackCards.filter(c => {
                const stats = attackStats[c.jp];
                return stats && stats.correct >= 3;
            }).length;
            
            progressEl.style.display = 'block';
            progressEl.innerHTML = `
                <div class="progress-stat">
                    <span>Gelernt:</span>
                    <strong>${learned} / ${total}</strong>
                </div>
                <div class="progress-stat">
                    <span>In Wiederholung:</span>
                    <strong>${attackReviewQueue.length}</strong>
                </div>
            `;
        }
        
        // ========================================
        // TECHNIKEN-BERICHT
        // ========================================
        
        function showTechnikenBericht() {
            const modal = document.getElementById('bericht-modal');
            const content = document.getElementById('bericht-content');
            
            // Techniken nach Bewertung filtern
            const schwer = [];
            const gehtSo = [];
            
            Object.keys(ratings).forEach(cardId => {
                const rating = ratings[cardId];
                const parts = cardId.split('_');
                // Format: Technik_Angriff_Variation
                const displayName = parts.join(' - ').replace(/_/g, ' ');
                
                if (rating === 'hard') {
                    schwer.push(displayName);
                } else if (rating === 'ok') {
                    gehtSo.push(displayName);
                }
            });
            
            let html = '';
            
            if (schwer.length === 0 && gehtSo.length === 0) {
                html = `
                    <div class="empty-state">
                        <div class="empty-state-icon">üìù</div>
                        <div>Noch keine Bewertungen vorhanden.<br>√úbe erst einige Techniken!</div>
                    </div>
                `;
            } else {
                // Kann ich nicht
                if (schwer.length > 0) {
                    html += `
                        <div class="category-section">
                            <div class="category-title" style="color: var(--error-color);">
                                üòì Kann ich nicht (${schwer.length})
                            </div>
                    `;
                    schwer.forEach(name => {
                        html += `<div class="technique-item">${name}</div>`;
                    });
                    html += `</div>`;
                }
                
                // Verbessern
                if (gehtSo.length > 0) {
                    html += `
                        <div class="category-section">
                            <div class="category-title" style="color: var(--warning-color);">
                                üòê Verbessern (${gehtSo.length})
                            </div>
                    `;
                    gehtSo.forEach(name => {
                        html += `<div class="technique-item">${name}</div>`;
                    });
                    html += `</div>`;
                }
                
                html += `
                    <div style="margin-top: 20px; padding: 15px; background: var(--bg-secondary); border-radius: 8px; font-size: 0.9em; color: var(--text-secondary);">
                        üí° <strong>Hinweis:</strong> Dieser Bericht zeigt deine selbst bewerteten Schw√§chen. 
                        Zeige ihn deinem Lehrer, um gezielt an diesen Techniken zu arbeiten.
                    </div>
                `;
            }
            
            content.innerHTML = html;
            modal.style.display = 'block';
        }
        
        function closeTechnikenBericht() {
            document.getElementById('bericht-modal').style.display = 'none';
        }

        // Daten laden
        async function loadData() {
            try {
                const response = await fetch('aikido_data.json');
                aikidoData = await response.json();
                
                // Attack cards extrahieren
                const attacksMap = new Map();
                aikidoData.forEach(t => {
                    if (!attacksMap.has(t.attack_jp)) {
                        attacksMap.set(t.attack_jp, t.attack_de);
                    }
                });
                attackCards = Array.from(attacksMap, ([jp, de]) => ({jp, de}));
                
                // Initialisierung
                renderPruefungsordnung();
                renderAngriffe();
                renderTechniken();
                
                console.log(`‚úì ${aikidoData.length} Techniken geladen`);
                console.log(`‚úì ${attackCards.length} Angriffe geladen`);
            } catch (error) {
                console.error('Fehler beim Laden der Daten:', error);
                document.querySelector('.container').innerHTML = `
                    <div class="empty-state">
                        <div class="empty-state-icon">‚ö†Ô∏è</div>
                        <div>Fehler beim Laden der Daten</div>
                    </div>
                `;
            }
        }

        // Service Worker registrieren
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('sw.js')
                .then(reg => console.log('‚úì Service Worker registriert'))
                .catch(err => console.log('Service Worker Fehler:', err));
        }

        // App starten
        loadData();
    </script>
</body>
</html>